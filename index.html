<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Lookup</title>
<style>
body {
font-family: Arial, sans-serif;
margin: 15px;
}
input, select {
width: 100%;
padding: 8px;
margin-bottom: 8px;
}
.product {
border-bottom: 1px solid #ddd;
padding: 10px 0;
}
.product img {
max-width: 120px;
margin-top: 5px;
}
.sku {
font-weight: bold;
font-size: 16px;
}
.small {
font-size: 14px;
color: #555;
}
</style>
</head>
<body>

<h3>Product Lookup</h3>

<input type="text" id="search" placeholder="Enter full or partial SKU">

<select id="categoryFilter">
<option value="">All Categories</option>
<option value="Washing Machine">Washing Machine</option>
<option value="TV">TV</option>
<option value="AC">AC</option>
<option value="Water Purifier">Water Purifier</option>
<option value="Microwave Oven">Microwave Oven</option>
<option value="Refrigerator">Refrigerator</option>
</select>

<select id="ratingFilter">
<option value="">All Ratings</option>
<option value="1">1 Star</option>
<option value="2">2 Star</option>
<option value="3">3 Star</option>
<option value="4">4 Star</option>
<option value="5">5 Star</option>
</select>

<select id="typeFilter">
<option value="">All Types</option>
<option value="Front Load">Front Load</option>
<option value="Top Load">Top Load</option>
<option value="Automatic">Automatic</option>
<option value="Semi-Automatic">Semi-Automatic</option>
</select>

<div id="results"></div>

<script>
let products = [];

async function fetchData() {
const SHEET_ID = "1y87usdTNDTIbCGwvyjaUmwReye_O9J1qEGMm_7YI_BM";
const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;
const response = await fetch(url);
const text = await response.text();
const json = JSON.parse(text.substring(47, text.length - 2));
const rows = json.table.rows;

products = rows.map(r => ({
sku: r.c[0]?.v || "",
category: r.c[1]?.v || "",
type: r.c[2]?.v || "",
automation: r.c[3]?.v || "",
rating: r.c[4]?.v?.toString() || "",
capacity: r.c[5]?.v || "",
description: r.c[6]?.v || "",
image: r.c[7]?.v || ""
}));

filterProducts();
}

function filterProducts() {
const query = document.getElementById("search").value.toUpperCase();
const category = document.getElementById("categoryFilter").value;
const rating = document.getElementById("ratingFilter").value;
const type = document.getElementById("typeFilter").value;
const resultsDiv = document.getElementById("results");

const filtered = products.filter(p =>
p.sku.toUpperCase().includes(query) &&
(category === "" || p.category === category) &&
(rating === "" || p.rating === rating) &&
(type === "" || p.type === type || p.automation === type)
);

resultsDiv.innerHTML = "";

if (filtered.length === 0) {
resultsDiv.innerHTML = "<p>No match found</p>";
return;
}

filtered.forEach(p => {
const div = document.createElement("div");
div.className = "product";

div.innerHTML = `
<div class="sku">${p.sku}</div>
<div class="small">
${p.category} | ${p.type} | ${p.rating} Star
</div>
<div class="small">${p.capacity}</div>
<div>${p.description}</div>
${p.image ? `<img src="${p.image}" alt="${p.sku}">` : ""}
`;

resultsDiv.appendChild(div);
});
}

document.getElementById("search").addEventListener("input", filterProducts);
document.getElementById("categoryFilter").addEventListener("change", filterProducts);
document.getElementById("ratingFilter").addEventListener("change", filterProducts);
document.getElementById("typeFilter").addEventListener("change", filterProducts);

fetchData();
</script>

</body>
</html>
